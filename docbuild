#!/bin/bash
# Script to build docs (and push them to GitHub Pages if "push" is the first parameter"

sphinx-build -b html doc/ doc/_build

if [ "$1" == "push" ]; then
    REF="`git rev-parse --abbrev-ref HEAD`:`git rev-parse HEAD`"
    git clone https://github.com/aki--aki/xbotpp.git pagesbranch -b gh-pages
    cp -R doc/_build/* pagesbranch/
    cd pagesbranch
    git add .
    git commit -m "Automatically generated docs from $REF"
    git push origin gh-pages
    cd ..
    rm -rf pagesbranch
fi

